/*! angular-envoy - v0.1.0
 * 
 * Copyright (c) 2015 Focusvision Worldwide; Licensed MIT
 */

(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";module.exports=require("./lib");
},{"./lib":14}],2:[function(require,module,exports){
"use strict";function action(n){return{restrict:"A",require:["ngModel","^form"],link:function(e,t,i,o){var c,a=o[0],r=o[1];(c=i.messageAction)&&a.$name&&r.$name&&n.setAction(r.$name,a.$name,function(){e.$eval(c)})}}}action.$inject=["$envoy"],module.exports=action;
},{}],3:[function(require,module,exports){
"use strict";module.exports={envoyAction:require("./action"),envoyMessages:require("./messages"),envoyList:require("./list"),envoyProxy:require("./proxy")};
},{"./action":2,"./list":4,"./messages":5,"./proxy":9}],4:[function(require,module,exports){
"use strict";function list(e){return{restrict:"EA",scope:!0,require:"^envoyMessages",templateUrl:opts.templateUrl,link:function(t,n,i,r){var o=e.findParentCtrl(i.envoyList||i["for"],r);o.bindView(t),t.$on("$destroy",function(){o.unbindView()})}}}var opts=require("../envoy/opts");list.$inject=["$envoy"],module.exports=list;
},{"../envoy/opts":12}],5:[function(require,module,exports){
"use strict";module.exports=require("./messages");
},{"./messages":7}],6:[function(require,module,exports){
(function (global){
"use strict";function MessagesCtrl(e,t,n,r,i){var a;this.bindView=function(e){if(a.scope)throw new Error("view already bound!");return a.scope=e,e.data=viewData(t.DEFAULT_LEVEL),this},this.unbindView=function(){return delete a.scope,this},function(){var o,s;Object.defineProperties(this,{$errorLevel:{get:function(){return s.$errorLevel},set:function(e){s.$errorLevel=e}},$name:{get:function(){return s.$name}},$viewData:{get:function(){var e;return(e=_.get(a,"scope.data"))?e:_.get(a,"scope")?a.scope.data=viewData(t.DEFAULT_LEVEL):void 0},set:function(e){a.scope.data=e}}}),s=this.$form=e.controller("form"),this.$parent=n.parent&&(o=i(n.parent)(r))?t.findParentCtrl(o,e.parent().controller("envoyMessages")):null,a=this.$parent?this.$view=this.$parent.$view:this.$view={}}.call(this)}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,viewData=require("./viewdata");MessagesCtrl.$inject=["$element","$envoy","$attrs","$scope","$interpolate"],module.exports=MessagesCtrl;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./viewdata":8}],7:[function(require,module,exports){
"use strict";function messages(e){return{restrict:"AE",require:"envoyMessages",controller:require("./messages-ctrl"),scope:!0,link:function(s,r,t,a){s.$on("$formStateChanged",function(s,r){var t,o=a.$viewData;o&&(t=r.errorLevel,o.messages=r.messages,o.error=!!t,o.className=r.errorLevelName,o.title=e.levelDescription(t),debug('envoyMessages directive for form "%s" received $formStateChanged event; view data:',a.$name,o))})}}}var debug=require("debug")("envoy:directives:messages");messages.$inject=["$envoy"],module.exports=messages;
},{"./messages-ctrl":6,"debug":15}],8:[function(require,module,exports){
(function (global){
"use strict";function viewData(e){var i={reset:function(){this.error=!1,this.messages={},this.title=null,this.className=null,this.errorLevel=e},id:_.uniqueId(ID_PREFIX)};return i.reset(),debug('Created viewdata object with id "%s"',i.id),i}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,ID_PREFIX="envoy-viewdata-",debug=require("debug")("envoy:directives:messages:viewdata");module.exports=viewData;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"debug":15}],9:[function(require,module,exports){
(function (global){
"use strict";function proxy(e){var r="proxy";return{restrict:"A",require:"ngModel",link:function(o,n,a,l){var t;(t=a.envoyProxy)&&(n.addClass("errorlevel"),o.$on("$formStateChanged",function(o,a){var i;_.find(a.forms,{$name:t})&&(_.each(e.ERRORLEVELS,function(e,r){n.removeClass(r)}),i=a.errorLevel,l.$setValidity(r,i),i&&n.addClass(a.errorLevelName))}))}}}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;proxy.$inject=["$envoy"],module.exports=proxy;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],10:[function(require,module,exports){
(function (global){
"use strict";function envoyFactory(e,r){function t(n){var o;return(o=t._cache[n.$name])?r.when(o):e.get(opts.dataFile,{cache:!0}).then(function(e){var r=e.data;return n&&(r=_(r[n.$alias||n.$name]).mapValues(function(e,r){var o=n[r],a=o&&_.size(o.$error);return o&&a?_(e).pick(_.keys(o.$error)).each(function(e){e.action=t.getAction(n.$name,r)}).value():void 0}).pick(_.identity).value()),t._cache[n.$name]=r,r})}var n,o=_.pluck(opts.levels,"name"),a=_(o).invert().mapValues(_.parseInt).value(),i={};return n={_cache:{},level:function(e){return _.isString(e)?a[e]||a[opts.defaultLevel]:o[e]||opts.defaultLevel},formErrorLevel:function(e){if(!e)throw new Error("parameter is required");return t(e).then(function(r){return t._formErrorLevel(e,r)})},_formErrorLevel:function(e,r){var n=a[opts.defaultLevel],i=_.reduce(r,function(r,n){var o=_(n).pick(function(r,t){return e.$error[t]}).pluck("level").map(t.level).max();return Math.max(r,o)},n);return debug('Computed errorLevel "%s" for form "%s"',t.level(i),e.$name),o[i]},_lastControl:null,_lastControlError:null,_emitting:null,$emit:function(e,n){var i=_.debounce(function(){var i=[e],l=e;for(debug('Broadcasting from form "%s"; "%s" changed',e.$name,n.$name);l.$$parentForm&&l.$$parentForm.$name;)l=l.$$parentForm,i.unshift(l);t._emitting=r.all(_.map(i,t)).then(function(r){var l=a[opts.defaultLevel],u={},c=_.reduce(r,function(e,r,n){var o=i[n],l=t._formErrorLevel(o,r),c=a[l];return o.$errorLevel=c,u[o.$name]=r,_.isNumber(c)?Math.max(e,c):e},l);e.$formScope.$emit("$formStateChanged",{errorLevel:c,errorLevelName:o[c],messages:_.omit(u,_.isEmpty),forms:i,control:n}),t._lastControl=n,t._lastControlError=_.keys(n.$error)})},BROADCAST_DEBOUNCE_MS);return delete t._cache[e.$name],t._emitting?t._emitting.then(t.$emit.bind(null,e,n)):r.when(i())},setAction:function(e,r,t){var n=i[e]=i[e]||{};n[r]=t},getAction:function(e,r){return _.get(i,_.format("%s.%s",e,r))},findParentCtrl:function(e,r){for(;r.$name!==e;)if(r=r.$parent,!r)throw new Error("cannot find parent with name "+e);return r},levelDescription:function(e){var r;return(r=t.LEVELS[e])&&r.description},DEFAULT_LEVEL:opts.defaultLevel,ERRORLEVELS:a,LEVELS:opts.levels,opts:opts},_.extend(t,n),t}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,opts=require("./opts"),BROADCAST_DEBOUNCE_MS=250,debug=require("debug")("envoy:$envoy:factory");envoyFactory.$inject=["$http","$q"],module.exports=envoyFactory;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./opts":12,"debug":15}],11:[function(require,module,exports){
(function (global){
"use strict";function envoyProvider(){this.options=function(e){return _.extend(opts,e),debug("New options set:",opts),opts},this.$get=require("./factory")}var opts=require("./opts"),_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,debug=require("debug")("envoy:$envoy:provider");module.exports=envoyProvider;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./factory":10,"./opts":12,"debug":15}],12:[function(require,module,exports){
"use strict";var DEFAULT_HIDE_DELAY=900,DEFAULT_LEVELS=[{name:"ok",description:"Fixed!"},{name:"warning",description:"Warning"},{name:"error",description:"Error"}],DEFAULT_DATA_FILE="messages.json",DEFAULT_LEVEL="ok";module.exports={levels:DEFAULT_LEVELS,defaultLevel:DEFAULT_LEVEL,dataFile:DEFAULT_DATA_FILE,hideDelay:DEFAULT_HIDE_DELAY,templateUrl:"partials/messages.html"};
},{}],13:[function(require,module,exports){
(function (global){
"use strict";function formDecorator(e){function t(e,t,r,o,s,a,n){var $;a.invoke(i,this,{$element:e,$scope:r,$animate:o,$interpolate:s,$attrs:t}),this.$isForm=!0,this.$name&&($=this.$setValidity,debug("Instantiating patched controller for form %s",this.$name),_.extend(this,{$alias:t.alias||this.$name,$formScope:r,$$lastErrorSize:0,$setValidity:function(e,t,r){var i=!r.$isForm,o=i&&_.has(this,r.$name);$.apply(this,arguments),o&&_.size(this.$error)!==this.$$lastErrorSize&&(n.$emit(this,r),this.$$lastErrorSize=_.size(this.$error))}}),_.has(r,this.$alias)||(r[this.$alias]=this))}var r=_.first(e),i=r.controller;return t.$inject=["$element","$attrs","$scope","$animate","$interpolate","$injector","$envoy"],r.controller=t,r.$scope=!0,e}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,debug=require("debug")("envoy:formDecorator");formDecorator.$inject=["$delegate"],module.exports=formDecorator;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"debug":15}],14:[function(require,module,exports){
(function (global){
"use strict";function config(e){e.decorator("ngFormDirective",require("./form-decorator")),debug("%s v%s ready",pkg.name,pkg.version)}var angular="undefined"!=typeof window?window.angular:"undefined"!=typeof global?global.angular:null,_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,directives=require("./directives"),pkg=require("../package.json"),MODULE_NAME="fv.envoy",debug=require("debug")("envoy"),envoy;config.$inject=["$provide"],envoy=angular.module(MODULE_NAME,[]).config(config).provider("$envoy",require("./envoy")),_.each(directives,function(e,n){envoy.directive(n,e)}),module.exports=envoy;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../package.json":18,"./directives":3,"./envoy":11,"./form-decorator":13,"debug":15}],15:[function(require,module,exports){
function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var o=arguments,e=this.useColors;if(o[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+o[0]+(e?"%c ":" ")+"+"+exports.humanize(this.diff),!e)return o;var r="color: "+this.color;o=[o[0],r,"color: inherit"].concat(Array.prototype.slice.call(o,1));var t=0,s=0;return o[0].replace(/%[a-z%]/g,function(o){"%%"!==o&&(t++,"%c"===o&&(s=t))}),o.splice(s,0,r),o}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(o){try{null==o?exports.storage.removeItem("debug"):exports.storage.debug=o}catch(e){}}function load(){var o;try{o=exports.storage.debug}catch(e){}return o}function localstorage(){try{return window.localStorage}catch(o){}}exports=module.exports=require("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(o){return JSON.stringify(o)},exports.enable(load());
},{"./debug":16}],16:[function(require,module,exports){
function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(e){function r(){}function o(){var e=o,r=+new Date,s=r-(prevTime||r);e.diff=s,e.prev=prevTime,e.curr=r,prevTime=r,null==e.useColors&&(e.useColors=exports.useColors()),null==e.color&&e.useColors&&(e.color=selectColor());var t=Array.prototype.slice.call(arguments);t[0]=exports.coerce(t[0]),"string"!=typeof t[0]&&(t=["%o"].concat(t));var n=0;t[0]=t[0].replace(/%([a-z%])/g,function(r,o){if("%%"===r)return r;n++;var s=exports.formatters[o];if("function"==typeof s){var p=t[n];r=s.call(e,p),t.splice(n,1),n--}return r}),"function"==typeof exports.formatArgs&&(t=exports.formatArgs.apply(e,t));var p=o.log||exports.log||console.log.bind(console);p.apply(e,t)}r.enabled=!1,o.enabled=!0;var s=exports.enabled(e)?o:r;return s.namespace=e,s}function enable(e){exports.save(e);for(var r=(e||"").split(/[\s,]+/),o=r.length,s=0;o>s;s++)r[s]&&(e=r[s].replace(/\*/g,".*?"),"-"===e[0]?exports.skips.push(new RegExp("^"+e.substr(1)+"$")):exports.names.push(new RegExp("^"+e+"$")))}function disable(){exports.enable("")}function enabled(e){var r,o;for(r=0,o=exports.skips.length;o>r;r++)if(exports.skips[r].test(e))return!1;for(r=0,o=exports.names.length;o>r;r++)if(exports.names[r].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=require("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevColor=0,prevTime;
},{"ms":17}],17:[function(require,module,exports){
function parse(e){if(e=""+e,!(e.length>1e4)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(a){var r=parseFloat(a[1]),c=(a[2]||"ms").toLowerCase();switch(c){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}}}function short(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function long(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s,"second")||e+" ms"}function plural(s,e,a){return e>s?void 0:1.5*e>s?Math.floor(s/e)+" "+a:Math.ceil(s/e)+" "+a+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(s,e){return e=e||{},"string"==typeof s?parse(s):e["long"]?long(s):short(s)};
},{}],18:[function(require,module,exports){
module.exports={"name":"angular-envoy","version":"0.1.0","description":"Highly flexible form validation messaging for AngularJS","main":"index.js","scripts":{"test":"echo \"Error: no test specified\" && exit 1"},"author":"Christopher Hiller <chiller@focusvision.com>","license":"MIT","devDependencies":{"angular":"^1.4.1","browserify":"^10.2.4","chai":"^3.0.0","eslint":"^0.23.0","exorcist":"^0.4.0","exposify":"^0.4.3","grunt":"^0.4.5","grunt-browserify":"^3.8.0","grunt-bump":"^0.3.1","grunt-cli":"^0.1.13","grunt-contrib-clean":"^0.6.0","grunt-dev-update":"^1.3.0","grunt-eslint":"^15.0.0","grunt-exorcise":"^2.0.0","grunt-mocha-cov":"^0.4.0","grunt-ngdocs":"^0.2.7","jit-grunt":"^0.9.1","load-grunt-config":"^0.17.1","minifyify":"^7.0.1","minimatch":"^2.0.8","mocha":"^2.2.5","mocha-lcov-reporter":"0.0.2","through2":"^2.0.0","time-grunt":"^1.2.1","transformify":"^0.1.2"},"peerDependencies":{"angular":"^1.4.1"},"dependencies":{"debug":"^2.2.0","lodash":"^3.9.3"}}
},{}]},{},[1])


//# sourceMappingURL=envoy.min.js.map