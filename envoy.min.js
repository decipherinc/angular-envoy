/*! angular-envoy - v0.0.1
 * 
 * Copyright (c) 2015 Focusvision Worldwide; Licensed MIT
 */

(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";module.exports=require("./lib");
},{"./lib":14}],2:[function(require,module,exports){
"use strict";function action(n){return{restrict:"A",require:["ngModel","^form"],link:function(e,t,o,i){var c,r=i[0],a=i[1];(c=o.envoyAction)&&r.$name&&a.$name&&n.setAction(a.$name,r.$name,function(){e.$eval(c)})}}}action.$inject=["$envoy"],module.exports=action;

},{}],3:[function(require,module,exports){
"use strict";module.exports={envoyAction:require("./action"),envoyMessages:require("./messages"),envoyList:require("./list"),envoyProxy:require("./proxy")};

},{"./action":2,"./list":4,"./messages":5,"./proxy":9}],4:[function(require,module,exports){
"use strict";function list(e){return{restrict:"EA",scope:!0,require:"^envoyMessages",templateUrl:opts.templateUrl,link:function(t,n,i,r){var o=e.findParentCtrl(i.envoyList||i["for"],r);o.bindView(t),t.$on("$destroy",function(){o.unbindView()})}}}var opts=require("../envoy/opts");list.$inject=["$envoy"],module.exports=list;

},{"../envoy/opts":12}],5:[function(require,module,exports){
"use strict";module.exports=require("./messages");

},{"./messages":7}],6:[function(require,module,exports){
(function (global){
"use strict";function MessagesCtrl(e,t,i,n,s){var r;this.bindView=function(e){if(r.scope)throw new Error("view already bound!");return r.scope=e,e.data=viewData(t.DEFAULT_LEVEL),debug("View bound"),this},this.update=function(e){var i,n=this.$viewData;return n?(debug('"%s" updating with new data:',this.$name,e),this.$errorLevel=i=_.isNumber(e.errorLevel)?e.errorLevel:this.$errorLevel,_.each(e.messages,function(e,t){n.messages[t]?_.each(e,function(e,i){_.isObject(e)?n.messages[t][i]?_.extend(n.messages[t][i],e):n.messages[t][i]=e:delete n.messages[t][i]}):n.messages[t]=e}),n.error=!!i,n.className=t.level(i),n.title=this.title(i),debug('"%s" updated; view data:',this.$name,n),n):void 0},this.unbindView=function(){return delete r.scope,r=null,debug("View unbound"),this},this.addChild=function(e){return debug('Adding child "%s" to "%s"',e.$name,this.$name),this.$children.push(e),e.$parent=this,this},this.removeChild=function(e){return debug('Removing child "%s" from "%s"',e.$name,this.$name),this.$children.splice(this.$children.indexOf(e),1),delete e.$parent,this},this.title=function(e){return t.levelDescription(e)},this.toString=function(){return this.$name},this.broadcast=n.$broadcast.bind(n),this.emit=n.$parent.$emit.bind(n.$parent),function(){var a,o;this.$children=[],this.$parent=null,Object.defineProperties(this,{$errorLevel:{get:function(){return o.$errorLevel},set:function(e){o.$errorLevel=e}},$name:{get:function(){return o.$name}},$viewData:{get:function(){var e;return(e=_.get(r,"scope.data"))?e:r.scope?r.scope.data=viewData(t.DEFAULT_LEVEL):void 0},set:function(e){r.scope.data=e}}}),o=this.$form=e.controller("form"),i.parent&&(a=s(i.parent)(n))&&(t.findParentCtrl(a,e.parent().controller("envoyMessages")).addChild(this),this.$parent.$form===o&&(this.$parent.removeChild(this),debug("Attempted to initialize %s with its own parent",o.$name))),this.$children=[],r=this.$parent?this.$view=this.$parent.$view:this.$view={},n.$on("$destroy",t.bindForm(this,this.$name))}.call(this)}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,viewData=require("./viewdata"),debug=require("debug")("envoy:directives:messages:controller");MessagesCtrl.$inject=["$element","$envoy","$attrs","$scope","$interpolate"],module.exports=MessagesCtrl;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./viewdata":8,"debug":15}],7:[function(require,module,exports){
"use strict";function messages(){return{restrict:"AE",require:"envoyMessages",controller:require("./messages-ctrl"),scope:!0,link:function(e,s,n,t){e.$on("$formStateChanged",function(e,s){t.update(s)}),e.$on("$destroy",function(){t.$parent.removeChild(t)})}}}messages.$inject=["$envoy"],module.exports=messages;

},{"./messages-ctrl":6}],8:[function(require,module,exports){
(function (global){
"use strict";function viewData(e){var i={reset:function(){this.error=!1,this.messages={},this.title=null,this.className=null,this.errorLevel=e},id:_.uniqueId(ID_PREFIX)};return i.reset(),debug('Created viewdata object with id "%s"',i.id),i}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,ID_PREFIX="envoy-viewdata-",debug=require("debug")("envoy:directives:messages:viewdata");module.exports=viewData;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"debug":15}],9:[function(require,module,exports){
(function (global){
"use strict";function proxy(){var e="proxy",r="errorlevel";return{restrict:"A",require:"ngModel",controller:["$scope","$element","$attrs","$envoy","$interpolate",function(o,n,t,l,i){var d=require("debug")("envoy:directives:proxy:controller"),s=i(t.envoyProxy||"")(o),a=n.controller("ngModel");if(this.update=function(r){var o=!r.errorLevel,t=l.level(r.errorLevel);d('Proxy "%s" updated w/ errorLevel %s',s,t),_.each(l.ERRORLEVELS,function(e,r){n.removeClass(r)}),a.$setValidity(e,o),o||n.addClass(t)},this.toString=function(){return this.$name+"-proxy"},this.$name=s,!s)throw new Error("envoyProxy directive needs a value!");n.addClass(r),o.$on("$destroy",l.bindForm(this,s))}]}}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=proxy;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"debug":15}],10:[function(require,module,exports){
(function (global){
"use strict";function envoyFactory(e,r){function n(t){var o;return(o=n._cache[t.$name])?r.when(o):e.get(opts.dataFile,{cache:!0}).then(function(e){var r=e.data;return t&&(r=_(r[t.$alias||t.$name]).mapValues(function(e,r){var o=t[r],a=o&&_.size(o.$error);return o&&a?_(e).pick(_.keys(o.$error)).each(function(e){e.action=n.getAction(t.$name,r)}).value():void 0}).value()),n._cache[t.$name]=r,r})}var t,o=_.pluck(opts.levels,"name"),a=_(o).invert().mapValues(_.parseInt).value(),u={},i={};return t={_cache:{},level:function(e){return _.isString(e)?a[e]||a[opts.defaultLevel]:o[e]||opts.defaultLevel},formErrorLevel:function(e){if(!e)throw new Error("parameter is required");return n(e).then(function(r){return n._formErrorLevel(e,r)})},_formErrorLevel:function(e,r){var t=a[opts.defaultLevel],o=_.reduce(r,function(r,t){var o=_(t).pick(function(r,n){return e.$error[n]}).pluck("level").map(n.level).max();return Math.max(r,o)},t),u=n.level(o);return debug('Computed errorLevel "%s" for form "%s"',u,e.$name),o},_emitting:null,bindForm:function(e,r){var n=i[r]=i[r]||{},t=_.uniqueId("envoy-binding-");return n[t]=e,function(){delete n[t]}},emit:function(e,t){function o(e,r){return r=r||[],e.$parent?(r.push(e.$parent),o(e.$parent,r)):r}function a(e,r){var n=e.$children;return r=r||[],n&&n.length?(r.push.apply(r,n),_(n).map(function(e){return a(e,r)}).flatten().unique().value()):r}function u(){_.each(_.toArray(arguments),function(e){_.each(e,function(e){e.$errorLevel=e.$errorLevel||n.DEFAULT_ERRORLEVEL})})}var l;return l=_.debounce(function(e,r){var t,l,c=_.toArray(i[e.$name]);c.length&&(t=_.filter(c,function(e){return e.$form}),l=_(t).map(function(e){return o(e)}).flatten().value(),u(l,t),n._emitting=n(e).then(function(o){function u(e){e.update({messages:v,errorLevel:f})}var i,f=n._formErrorLevel(e,o),v=_.object([e.$name],[o]);if(e.$errorLevel<f)i=!0;else{if(!(e.$errorLevel>f))return;i=!1}_.each(o[r.$name],function(t){t.action=n.getAction(e.$name,r.$name)}),i===!1&&(f=Math.max(f,_(t).map(function(e){return a(e)}).flatten().map(function(e){return _.isNumber(e.$errorLevel)?e.$errorLevel:n.DEFAULT_ERRORLEVEL}).max())),_.each(c,u),_.each(l,function(e){i?e.$errorLevel<f?u(e):e.$errorLevel>f&&(f=e.$errorLevel,u(e)):e.$errorLevel>f?u(e):e.$errorLevel<f&&(f=e.$errorLevel,u(e))})})["catch"](function(e){debug(e)}))}),delete n._cache[e.$name],debug('Control "%s" in form "%s" changed validity',t.$name,e.$name),n._emitting?n._emitting.then(l.bind(null,e,t)):r.when(l(e,t))},setAction:function(e,r,n){var t=u[e]=u[e]||{};t[r]=n},getAction:function(e,r){return _.get(u,_.format("%s.%s",e,r))},findParentCtrl:function(e,r){for(;r.$name!==e;)if(r=r.$parent,!r)throw new Error("cannot find parent with name "+e);return r},levelDescription:function(e){return opts.levels[e].description},DEFAULT_LEVEL:opts.defaultLevel,DEFAULT_ERRORLEVEL:a[opts.defaultLevel],ERRORLEVELS:a,LEVELS:opts.levels,opts:opts},_.extend(n,t),n}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,opts=require("./opts"),debug=require("debug")("envoy:$envoy:factory");envoyFactory.$inject=["$http","$q"],module.exports=envoyFactory;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./opts":12,"debug":15}],11:[function(require,module,exports){
(function (global){
"use strict";function envoyProvider(){this.options=function(e){return _.extend(opts,e),debug("New options set:",opts),opts},this.$get=require("./factory")}var opts=require("./opts"),_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,debug=require("debug")("envoy:$envoy:provider");module.exports=envoyProvider;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./factory":10,"./opts":12,"debug":15}],12:[function(require,module,exports){
"use strict";var DEFAULT_HIDE_DELAY=900,DEFAULT_LEVELS=[{name:"ok",description:"Fixed!"},{name:"warning",description:"Warning"},{name:"error",description:"Error"}],DEFAULT_DATA_FILE="messages.json",DEFAULT_LEVEL="ok";module.exports={levels:DEFAULT_LEVELS,defaultLevel:DEFAULT_LEVEL,dataFile:DEFAULT_DATA_FILE,hideDelay:DEFAULT_HIDE_DELAY,templateUrl:"partials/messages.html"};

},{}],13:[function(require,module,exports){
(function (global){
"use strict";function formDecorator(e){function t(e,t,r,o,s,a,n){var $;a.invoke(i,this,{$element:e,$scope:r,$animate:o,$interpolate:s,$attrs:t}),this.$isForm=!0,this.$name&&($=this.$setValidity,debug("Instantiating patched controller for form %s",this.$name),_.extend(this,{$alias:t.alias||this.$name,$formScope:r,$$lastErrorSize:0,$setValidity:function(e,t,r){var i=!r.$isForm,o=i&&_.has(this,r.$name);$.apply(this,arguments),o&&_.size(this.$error)!==this.$$lastErrorSize&&(n.emit(this,r),this.$$lastErrorSize=_.size(this.$error))}}),_.has(r,this.$alias)||(r[this.$alias]=this))}var r=_.first(e),i=r.controller;return t.$inject=["$element","$attrs","$scope","$animate","$interpolate","$injector","$envoy"],r.controller=t,r.$scope=!0,e}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,debug=require("debug")("envoy:formDecorator");formDecorator.$inject=["$delegate"],module.exports=formDecorator;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"debug":15}],14:[function(require,module,exports){
(function (global){
"use strict";function config(e){e.decorator("ngFormDirective",require("./form-decorator")),debug("%s v%s ready",pkg.name,pkg.version)}var angular="undefined"!=typeof window?window.angular:"undefined"!=typeof global?global.angular:null,_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,directives=require("./directives"),pkg=require("../package.json"),MODULE_NAME="fv.envoy",debug=require("debug")("envoy"),envoy;config.$inject=["$provide"],envoy=angular.module(MODULE_NAME,[]).config(config).provider("$envoy",require("./envoy")),_.each(directives,function(e,n){envoy.directive(n,e)}),module.exports=envoy;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../package.json":18,"./directives":3,"./envoy":11,"./form-decorator":13,"debug":15}],15:[function(require,module,exports){
function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var o=arguments,e=this.useColors;if(o[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+o[0]+(e?"%c ":" ")+"+"+exports.humanize(this.diff),!e)return o;var r="color: "+this.color;o=[o[0],r,"color: inherit"].concat(Array.prototype.slice.call(o,1));var t=0,s=0;return o[0].replace(/%[a-z%]/g,function(o){"%%"!==o&&(t++,"%c"===o&&(s=t))}),o.splice(s,0,r),o}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(o){try{null==o?exports.storage.removeItem("debug"):exports.storage.debug=o}catch(e){}}function load(){var o;try{o=exports.storage.debug}catch(e){}return o}function localstorage(){try{return window.localStorage}catch(o){}}exports=module.exports=require("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(o){return JSON.stringify(o)},exports.enable(load());

},{"./debug":16}],16:[function(require,module,exports){
function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(e){function r(){}function o(){var e=o,r=+new Date,s=r-(prevTime||r);e.diff=s,e.prev=prevTime,e.curr=r,prevTime=r,null==e.useColors&&(e.useColors=exports.useColors()),null==e.color&&e.useColors&&(e.color=selectColor());var t=Array.prototype.slice.call(arguments);t[0]=exports.coerce(t[0]),"string"!=typeof t[0]&&(t=["%o"].concat(t));var n=0;t[0]=t[0].replace(/%([a-z%])/g,function(r,o){if("%%"===r)return r;n++;var s=exports.formatters[o];if("function"==typeof s){var p=t[n];r=s.call(e,p),t.splice(n,1),n--}return r}),"function"==typeof exports.formatArgs&&(t=exports.formatArgs.apply(e,t));var p=o.log||exports.log||console.log.bind(console);p.apply(e,t)}r.enabled=!1,o.enabled=!0;var s=exports.enabled(e)?o:r;return s.namespace=e,s}function enable(e){exports.save(e);for(var r=(e||"").split(/[\s,]+/),o=r.length,s=0;o>s;s++)r[s]&&(e=r[s].replace(/\*/g,".*?"),"-"===e[0]?exports.skips.push(new RegExp("^"+e.substr(1)+"$")):exports.names.push(new RegExp("^"+e+"$")))}function disable(){exports.enable("")}function enabled(e){var r,o;for(r=0,o=exports.skips.length;o>r;r++)if(exports.skips[r].test(e))return!1;for(r=0,o=exports.names.length;o>r;r++)if(exports.names[r].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=require("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevColor=0,prevTime;

},{"ms":17}],17:[function(require,module,exports){
function parse(e){if(e=""+e,!(e.length>1e4)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(a){var r=parseFloat(a[1]),c=(a[2]||"ms").toLowerCase();switch(c){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}}}function short(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function long(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s,"second")||e+" ms"}function plural(s,e,a){return e>s?void 0:1.5*e>s?Math.floor(s/e)+" "+a:Math.ceil(s/e)+" "+a+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(s,e){return e=e||{},"string"==typeof s?parse(s):e["long"]?long(s):short(s)};

},{}],18:[function(require,module,exports){
module.exports={"name":"angular-envoy","version":"0.0.1","description":"Highly flexible form validation messaging for AngularJS","main":"index.js","author":"Christopher Hiller <chiller@focusvision.com>","license":"MIT","repository":{"type":"git","url":"https://github.com/decipherinc/angular-envoy.git"},"devDependencies":{"angular":"^1.4.1","browserify":"^10.2.4","chai":"^3.0.0","exposify":"^0.4.3","grunt":"^0.4.5","grunt-browserify":"^3.8.0","grunt-bump":"^0.3.1","grunt-cli":"^0.1.13","grunt-dev-update":"^1.3.0","grunt-eslint":"^15.0.0","grunt-mocha-cov":"^0.4.0","grunt-ngdocs":"^0.2.7","jit-grunt":"^0.9.1","jsonminifyify":"^0.1.1","load-grunt-config":"^0.17.1","minimatch":"^2.0.8","mocha":"^2.2.5","mocha-lcov-reporter":"0.0.2","time-grunt":"^1.2.1","uglifyify":"^3.0.1"},"scripts":{"test":"grunt test"},"peerDependencies":{"angular":"^1.4.1"},"dependencies":{"debug":"^2.2.0","lodash":"^3.9.3"}}
},{}]},{},[1]);
