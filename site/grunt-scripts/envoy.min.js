/*! angular-envoy - v0.0.1
 * 
 * Copyright (c) 2015 Focusvision Worldwide; Licensed MIT
 */

require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";module.exports=require("./lib");
},{"./lib":13}],2:[function(require,module,exports){
"use strict";function action(n){return{restrict:"A",require:["ngModel","^form"],link:function(e,t,o,i){var c,r=i[0],a=i[1];(c=o.envoyAction)&&r.$name&&a.$name&&n.setAction(a.$name,r.$name,function(){e.$eval(c)})}}}action.$inject=["$envoy"],module.exports=action;

},{}],3:[function(require,module,exports){
"use strict";module.exports={envoyAction:require("./action"),envoyMessages:require("./messages"),envoyList:require("./list"),envoyProxy:require("./proxy")};

},{"./action":2,"./list":4,"./messages":5,"./proxy":8}],4:[function(require,module,exports){
"use strict";function list(e,t){var r={restrict:"EA",scope:!0,require:"?^envoyMessages",templateUrl:opts.templateUrl,link:function(r,o,n,i){var s,l=n.envoyList||n["for"];if(l)s=e.findParentController(t(l)(r),i);else{if(!i)throw new Error("envoyList requires an ancestor envoyMessages directive or a form name");s=i}s.bindView(r),r.$on("$destroy",function(){s.unbindView()})}};return opts.template&&(r.template=opts.template,delete r.templateUrl),r}var opts=require("../envoy/opts");list.$inject=["$envoy","$interpolate"],module.exports=list;

},{"../envoy/opts":11}],5:[function(require,module,exports){
"use strict";function messages(e,r){return{restrict:"AE",require:"envoyMessages",controller:require("./messages-ctrl"),scope:!0,link:function(t,n,s,o){var i;s.parent&&(i=e(s.parent)(t))&&(r.findParentController(i,n.parent().controller("envoyMessages")).addChild(o),o.$parent.$form===o.$form&&(o.$parent.removeChild(o),debug("Attempted to initialize %s with its own parent",o.$form.$name))),t.$on("$destroy",function(){o.$parent&&o.$parent.removeChild(o)})}}}var debug=require("debug")("envoy:directives:messages");messages.$inject=["$interpolate","$envoy"],module.exports=messages;

},{"./messages-ctrl":6,"debug":"debug"}],6:[function(require,module,exports){
(function (global){
"use strict";function EnvoyMessagesController(e,t,i){var n;this.bindView=function(e){if(n.scope)throw new Error("view already bound!");return n.scope=e,e.$envoyData=viewData(t.DEFAULT_LEVEL),debug("View bound"),this},this.unbindView=function(){return n&&(delete n.scope,n=null,debug("View unbound")),this},this.update=function(e){var i,n=this.$viewData;return n?(debug('"%s" updating with new data:',this.$name,e),this.$errorLevel=i=_.isNumber(e.errorLevel)?e.errorLevel:this.$errorLevel,_.each(e.messages,function(e,t){n.messages[t]?_.each(e,function(e,i){_.isObject(e)?n.messages[t][i]?_.extend(n.messages[t][i],e):n.messages[t][i]=e:delete n.messages[t][i]}):n.messages[t]=e}),n.error=!!i,n.className=t.level(i),n.title=this.title(i),debug('"%s" updated; view data:',this.$name,n),n):void 0},this.addChild=function(e){return debug('Adding child "%s" to "%s"',e.$name,this.$name),this.$children.push(e),e.$parent=this,this},this.removeChild=function(e){return debug('Removing child "%s" from "%s"',e.$name,this.$name),this.$children.splice(this.$children.indexOf(e),1),delete e.$parent,this},this.title=function(e){return t.levelDescription(e)},this.toString=function(){return this.$name},function(){var s;this.$children=[],this.$parent=null,Object.defineProperties(this,{$errorLevel:{get:function(){return s.$errorLevel},set:function(e){s.$errorLevel=e}},$name:{get:function(){return s.$name}},$viewData:{get:function(){var e;return(e=_.get(n,"scope.$envoyData"))?e:n.scope?n.scope.$envoyData=viewData(t.DEFAULT_LEVEL):void 0},set:function(e){n.scope.$envoyData=e}}}),s=this.$form=e.controller("form"),this.$errorLevel=t.DEFAULT_ERRORLEVEL,n=this.$parent?this.$view=this.$parent.$view:this.$view={},i.$on("$destroy",t.bindForm(this,this.$name))}.call(this)}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,viewData=require("./viewdata"),debug=require("debug")("envoy:directives:messages:controller");EnvoyMessagesController.$inject=["$element","$envoy","$scope"],module.exports=EnvoyMessagesController;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./viewdata":7,"debug":"debug"}],7:[function(require,module,exports){
(function (global){
"use strict";function viewData(e){var i={reset:function(){this.error=!1,this.messages={},this.title=null,this.className=null,this.errorLevel=e},id:_.uniqueId(ID_PREFIX)};return i.reset(),debug('Created viewdata object with id "%s"',i.id),i}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,ID_PREFIX="envoy-viewdata-",debug=require("debug")("envoy:directives:messages:viewdata");module.exports=viewData;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"debug":"debug"}],8:[function(require,module,exports){
(function (global){
"use strict";function proxy(){var e="proxy",r="errorlevel";return{restrict:"A",require:"ngModel",controller:["$scope","$element","$attrs","$envoy","$interpolate","$animate",function(o,n,t,i,l,a){var d=require("debug")("envoy:directives:proxy:controller"),s=l(t.envoyProxy||"")(o),u=n.controller("ngModel");if(a=a||n,this.update=function(r){var o=!r.errorLevel,t=i.level(r.errorLevel);d('Proxy "%s" updated w/ errorLevel %s',s,t),_.each(i.ERRORLEVELS,function(e,r){a.removeClass(n,r)}),u.$setValidity(e,o),o||a.addClass(n,t)},this.toString=function(){return this.$name+"-proxy"},this.$name=s,!s)throw new Error("envoyProxy directive needs a value!");n.addClass(r),o.$on("$destroy",i.bindForm(this,s))}]}}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null;module.exports=proxy;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"debug":"debug"}],9:[function(require,module,exports){
(function (global){
"use strict";function envoyFactory(e,n){function r(t){var o;return t?(o=r._cache[t.$name])?n.when(o):function(r){return r.messagesConfig?n.when(r.messagesConfig):e.get(r.messagesConfigUrl,{cache:!0}).then(function(e){return e.data})}(opts).then(function(e){return e=_(e[t.$alias||t.$name]).mapValues(function(e,n){var o,a=t[n];return a&&_.size(o=a.$error)?_(e).pick(_.keys(o)).each(function(e){e.action=r.getAction(t.$name,n)}).value():void 0}).value(),r._cache[t.$name]=e,e}):n.reject(new Error('Must pass "form" parameter'))}var t,o=_.pluck(opts.levels,"name"),a=_(o).invert().mapValues(_.parseInt).value(),u={},i={};return t={_cache:{},level:function(e){return _.isString(e)?a[e]||a[opts.defaultLevel]:o[e]||opts.defaultLevel},_formErrorLevel:function(e,n){var t=r.DEFAULT_ERRORLEVEL,o=_.reduce(n,function(n,t){var o=_(t).pick(function(n,r){return e.$error[r]}).pluck("level").map(r.level).max();return Math.max(n,o)},t),a=r.level(o);return debug('Computed errorLevel "%s" for form "%s"',a,e.$name),o},_refreshing:null,bindForm:function(e,n){var r=i[n]=i[n]||{},t=_.uniqueId("envoy-binding-");return r[t]=e,function(){delete r[t]}},_findParents:function l(e,n){return n=n||[],e.$parent?(n.push(e.$parent),l(e.$parent,n)):n},_findChildren:function c(e,n){var r=e.$children;return n=n||[],r&&r.length?(n.push.apply(n,r),_(r).map(function(e){return c(e,n)}).flatten().unique().value()):n},_refresh:_.debounce(function(e,n){var t,o,a=_.toArray(i[e.$name]);a.length&&(t=_.filter(a,function(e){return e.$form}),o=_(t).map(function(e){return r._findParents(e)}).flatten().unique().value(),r._refreshing=r(e).then(function(u){function i(e){e.update({messages:f,errorLevel:c})}var l,c=r._formErrorLevel(e,u),f=_.object([e.$name],[u]);if(e.$errorLevel<c)l=!0;else{if(!(e.$errorLevel>c))return;l=!1}_.each(u[n.$name],function(t){t.action=r.getAction(e.$name,n.$name)}),l===!1&&(c=Math.max(c,_(t).map(function(e){return r._findChildren(e)}).flatten().map(function(e){return _.isNumber(e.$errorLevel)?e.$errorLevel:r.DEFAULT_ERRORLEVEL}).max())),_.each(a,i),_.each(o,function(e){l?e.$errorLevel<c?i(e):e.$errorLevel>c&&(c=e.$errorLevel,i(e)):e.$errorLevel>c?i(e):e.$errorLevel<c&&(c=e.$errorLevel,i(e))})})["catch"](function(e){debug(e)}))},DEBOUNCE_MS),refresh:function(e,t){return delete r._cache[e.$name],debug('Control "%s" in form "%s" changed validity',t.$name,e.$name),r._refreshing?r._refreshing.then(r._refresh.bind(null,e,t)):n.when(r._refresh(e,t))},setAction:function(e,n,r){var t=u[e]=u[e]||{};t[n]=r},getAction:function(e,n){return _.get(u,e+"."+n)},findParentController:function(e,n){for(;n.$name!==e;)if(n=n.$parent,!n)throw new Error("cannot find parent with name "+e);return n},levelDescription:function(e){return _.isString(e)&&(e=r.level(e)),opts.levels[e].description},DEFAULT_LEVEL:opts.defaultLevel,DEFAULT_ERRORLEVEL:a[opts.defaultLevel],ERRORLEVELS:a,LEVELS:opts.levels,options:opts},_.extend(r,t),r}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,opts=require("./opts"),debug=require("debug")("envoy:$envoy:factory"),DEBOUNCE_MS=250;envoyFactory.$inject=["$http","$q"],module.exports=envoyFactory;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./opts":11,"debug":"debug"}],10:[function(require,module,exports){
(function (global){
"use strict";function envoyProvider(){this.options=function(e){return _.extend(opts,e),debug("New options set:",opts),opts},this.$get=require("./factory")}var opts=require("./opts"),_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,debug=require("debug")("envoy:$envoy:provider");module.exports=envoyProvider;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./factory":9,"./opts":11,"debug":"debug"}],11:[function(require,module,exports){
"use strict";var DEFAULT_LEVELS=[{name:"ok",description:"Fixed!"},{name:"warning",description:"Warning"},{name:"error",description:"Error"}],DEFAULT_MESSAGES_CONFIG_URL="example-data/messages.json",DEFAULT_LEVEL="ok",DEFAULT_SHOW_DEFAULT_LEVEL=!1,DEFAULT_TEMPLATE_URL="partials/messages.html",DEFAULT_TEMPLATE=null,DEFAULT_MESSAGE_CONFIG=null;module.exports={levels:DEFAULT_LEVELS,defaultLevel:DEFAULT_LEVEL,messagesConfigUrl:DEFAULT_MESSAGES_CONFIG_URL,showDefaultLevel:DEFAULT_SHOW_DEFAULT_LEVEL,templateUrl:DEFAULT_TEMPLATE_URL,messagesConfig:DEFAULT_MESSAGE_CONFIG,template:DEFAULT_TEMPLATE};

},{}],12:[function(require,module,exports){
(function (global){
"use strict";function formDecorator(e){function t(e,t,r,o,s,a,n){var $;a.invoke(i,this,{$element:e,$scope:r,$animate:o,$interpolate:s,$attrs:t}),this.$name&&(this.$isForm=!0,$=this.$setValidity,debug("Instantiating patched controller for form %s",this.$name),_.extend(this,{$alias:t.alias||this.$name,$$lastErrorSize:0,$setValidity:function(e,t,r){var i=!r.$isForm,o=i&&_.has(this,r.$name);$.apply(this,arguments),o&&_.size(this.$error)!==this.$$lastErrorSize&&(n.refresh(this,r),this.$$lastErrorSize=_.size(this.$error))}}),_.has(r,this.$alias)||(r[this.$alias]=this))}var r=_.first(e),i=r.controller;return t.$inject=["$element","$attrs","$scope","$animate","$interpolate","$injector","$envoy"],r.controller=t,r.$scope=!0,e}var _="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,debug=require("debug")("envoy:formDecorator");formDecorator.$inject=["$delegate"],module.exports=formDecorator;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"debug":"debug"}],13:[function(require,module,exports){
(function (global){
"use strict";function config(e){e.decorator("ngFormDirective",formDecorator),ngAnimatePresent||e.value("$animate",null),debug("%s v%s ready",pkg.name,pkg.version)}var angular="undefined"!=typeof window?window.angular:"undefined"!=typeof global?global.angular:null,_="undefined"!=typeof window?window._:"undefined"!=typeof global?global._:null,directives=require("./directives"),pkg=require("../package.json"),formDecorator=require("./form-decorator"),$envoy=require("./envoy"),MODULE_NAME="fv.envoy",debug=require("debug")("envoy"),envoy,ngAnimatePresent=!1;config.$inject=["$provide"];try{envoy=angular.module(MODULE_NAME,["ngAnimate"]),ngAnimatePresent=!0}catch(ignored){envoy=angular.module(MODULE_NAME,[])}envoy.config(config).provider("$envoy",$envoy),_.each(directives,function(e,n){envoy.directive(n,e)}),module.exports=envoy;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../package.json":14,"./directives":3,"./envoy":10,"./form-decorator":12,"debug":"debug"}],14:[function(require,module,exports){
module.exports={"name":"angular-envoy","version":"0.0.1","description":"Highly flexible form validation messaging for AngularJS","main":"index.js","author":"Christopher Hiller <chiller@focusvision.com>","license":"MIT","repository":{"type":"git","url":"https://github.com/decipherinc/angular-envoy.git"},"devDependencies":{"angular":"^1.4.1","chai":"^3.0.0","exposify":"^0.4.3","grunt":"^0.4.5","grunt-bower-install-simple":"^1.1.3","grunt-browserify":"^3.8.0","grunt-bump":"^0.3.1","grunt-cli":"^0.1.13","grunt-contrib-clean":"^0.6.0","grunt-contrib-copy":"^0.8.0","grunt-dev-update":"^1.3.0","grunt-eslint":"^15.0.0","grunt-gh-pages":"^0.10.0","grunt-lodash":"^0.4.0","grunt-lodash-autobuild":"^0.3.0","grunt-mocha-istanbul":"^2.4.0","grunt-ngdocs":"^0.2.7","istanbul":"^0.3.17","jit-grunt":"^0.9.1","jsonminifyify":"^0.1.1","load-grunt-config":"^0.17.1","lodash-cli":"^3.10.0","mocha":"^2.2.5","time-grunt":"^1.2.1","uglifyify":"^3.0.1"},"scripts":{"test":"grunt test"},"peerDependencies":{"angular":"^1.4.1"},"dependencies":{"angular-animate":"^1.3.17","debug":"^2.2.0","lodash":"^3.9.3"}}
},{}],"debug":[function(require,module,exports){
module.exports=function(){};

},{}]},{},[1]);
