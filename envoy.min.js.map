{"version":3,"sources":["node_modules/grunt-browserify/node_modules/browserify/node_modules/browser-pack/_prelude.js","package.json","index.js","lib/index.js","lib/form-decorator.js","lib/directives/index.js","lib/envoy/index.js","node_modules/debug/browser.js","lib/directives/action.js","lib/directives/list.js","lib/directives/proxy.js","lib/envoy/factory.js","lib/envoy/opts.js","lib/directives/messages/index.js","node_modules/debug/debug.js","lib/directives/messages/messages.js","node_modules/debug/node_modules/ms/index.js","lib/directives/messages/messages-ctrl.js","lib/directives/messages/viewdata.js"],"names":["module","exports","require","config","$provide","decorator","debug","pkg","name","version","angular","window","global","_","directives","MODULE_NAME","envoy","$inject","provider","each","directive","formDecorator","$delegate","MessagesFormController","$element","$attrs","$scope","$animate","$interpolate","$injector","$envoy","$setValidity","invoke","formController","this","$isForm","$name","extend","$alias","alias","$formScope","$$lastErrorSize","token","value","control","isNotForm","formHasControl","has","apply","arguments","size","$error","emit","form","first","controller","envoyAction","envoyMessages","envoyList","envoyProxy","envoyProvider","options","newOpts","opts","$get","useColors","document","documentElement","style","console","firebug","exception","table","navigator","userAgent","toLowerCase","match","parseInt","RegExp","$1","formatArgs","args","namespace","humanize","diff","c","color","concat","Array","prototype","slice","call","index","lastC","replace","splice","log","Function","save","namespaces","storage","removeItem","e","load","r","localstorage","localStorage","chrome","local","colors","formatters","j","v","JSON","stringify","enable","action","restrict","link","scope","element","attrs","ctrls","ngModel","setAction","$eval","list","templateUrl","parent","findParentCtrl","bindView","$on","unbindView","proxy","TOKEN","CLASSNAME","target","update","data","isValid","errorLevel","errorLevelName","level","ERRORLEVELS","errorlevel","removeClass","addClass","toString","Error","bindForm","envoyFactory","$http","$q","result","_cache","when","get","dataFile","cache","then","res","messages","mapValues","controlMsgOptions","controlMsgName","formControl","error","pick","keys","tokenInfo","getAction","LEVEL_ARRAY","pluck","levels","LEVELS","invert","actions","bindings","isString","defaultLevel","formErrorLevel","formMessages","_formErrorLevel","defaultLevelNum","maxLevel","reduce","controlMsgOpts","maxControlLevel","tokenOpts","tokenName","map","max","Math","_emitting","ctrl","formName","formBindings","id","uniqueId","findParents","$parent","push","findChildren","children","$children","length","child","flatten","unique","setDefaultCtrlLevels","toArray","$errorLevel","DEFAULT_ERRORLEVEL","_emit","debounce","messageCtrls","parentCtrls","boundCtrls","filter","$form","lastErrorLevel","increasing","object","childCtrl","isNumber","err","bind","controlName","formActions","format","levelDescription","description","DEFAULT_LEVEL","DEFAULT_HIDE_DELAY","DEFAULT_LEVELS","DEFAULT_DATA_FILE","hideDelay","selectColor","prevColor","disabled","enabled","self","curr","Date","ms","prevTime","prev","coerce","formatter","val","logFn","fn","split","len","i","skips","substr","names","disable","test","stack","message","evt","removeChild","parse","str","exec","n","parseFloat","type","y","d","h","m","s","short","round","long","plural","floor","ceil","MessagesCtrl","view","viewData","$viewData","controlMessages","isObject","className","title","addChild","indexOf","broadcast","$broadcast","$emit","parentName","Object","defineProperties","set","$view","reset","ID_PREFIX"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports={\"name\":\"angular-envoy\",\"version\":\"0.0.1\",\"description\":\"Highly flexible form validation messaging for AngularJS\",\"main\":\"index.js\",\"author\":\"Christopher Hiller <chiller@focusvision.com>\",\"license\":\"MIT\",\"repository\":{\"type\":\"git\",\"url\":\"https://github.com/decipherinc/angular-envoy.git\"},\"devDependencies\":{\"angular\":\"^1.4.1\",\"browserify\":\"^10.2.4\",\"chai\":\"^3.0.0\",\"exorcist\":\"^0.4.0\",\"exposify\":\"^0.4.3\",\"grunt\":\"^0.4.5\",\"grunt-browserify\":\"^3.8.0\",\"grunt-bump\":\"^0.3.1\",\"grunt-cli\":\"^0.1.13\",\"grunt-dev-update\":\"^1.3.0\",\"grunt-eslint\":\"^15.0.0\",\"grunt-exorcise\":\"^2.0.0\",\"grunt-mocha-cov\":\"^0.4.0\",\"grunt-ngdocs\":\"^0.2.7\",\"jit-grunt\":\"^0.9.1\",\"load-grunt-config\":\"^0.17.1\",\"minifyify\":\"^7.0.1\",\"minimatch\":\"^2.0.8\",\"mocha\":\"^2.2.5\",\"mocha-lcov-reporter\":\"0.0.2\",\"time-grunt\":\"^1.2.1\"},\"peerDependencies\":{\"angular\":\"^1.4.1\"},\"dependencies\":{\"debug\":\"^2.2.0\",\"lodash\":\"^3.9.3\"}}","'use strict';\n\nmodule.exports = require('./lib');\n","'use strict';\n\nvar angular = (typeof window !== \"undefined\" ? window.angular : typeof global !== \"undefined\" ? global.angular : null);\nvar _ = (typeof window !== \"undefined\" ? window._ : typeof global !== \"undefined\" ? global._ : null);\nvar directives = require('./directives');\nvar pkg = require('../package.json');\n\nvar MODULE_NAME = 'fv.envoy';\nvar debug = require('debug')('envoy');\nvar envoy;\n\nfunction config($provide) {\n  $provide.decorator('ngFormDirective', require('./form-decorator'));\n  debug('%s v%s ready', pkg.name, pkg.version);\n}\nconfig.$inject = ['$provide'];\n\nenvoy = angular.module(MODULE_NAME, [])\n  .config(config)\n  .provider('$envoy', require('./envoy'));\n\n_.each(directives, function (directive, name) {\n  envoy.directive(name, directive);\n});\n\nmodule.exports = envoy;\n\n","'use strict';\n\nvar _ = (typeof window !== \"undefined\" ? window._ : typeof global !== \"undefined\" ? global._ : null);\n\nvar debug = require('debug')('envoy:formDecorator');\n\n/**\n * This decorator monkeypatches the controller property of the ngForm\n * directive.\n * For some reason when you decorate a directive, $delegate is an Array\n * and the first element is the directive.\n * @param {Array} $delegate Directive(s) associated with tag \"form\", I guess\n * @returns {Array} Decorated array of directives?\n */\nfunction formDecorator($delegate) {\n\n  /**\n   * The real form directive.\n   * @type {form}\n   */\n  var form = _.first($delegate);\n\n  /**\n   * Original FormController.\n   * @type {form.FormController}\n   */\n  var formController = form.controller;\n\n  /**\n   * We're monkeypatching FormController with this, if and only if\n   * the form has a name.\n   * @constructor\n   */\n  function MessagesFormController($element,\n    $attrs,\n    $scope,\n    $animate,\n    $interpolate,\n    $injector,\n    $envoy) {\n\n    // my kingdom for \"let\"\n    var $setValidity;\n\n    $injector.invoke(formController, this, {\n      $element: $element,\n      $scope: $scope,\n      $animate: $animate,\n      $interpolate: $interpolate,\n      $attrs: $attrs\n    });\n\n    /**\n     * This is a form.  This comes in handy, because NgModelController\n     * and FormController are very similar.\n     * @type {boolean}\n     */\n    this.$isForm = true;\n\n    if (this.$name) {\n\n      /**\n       * This FormController's original $setValidity() method\n       * @type {form.FormController#$setValidity}\n       */\n      $setValidity = this.$setValidity;\n\n      debug('Instantiating patched controller for form %s',\n        this.$name);\n\n      _.extend(this, {\n\n        /**\n         * If this form contains an \"alias\" attribute, we'll use it\n         * to look up messages.  This is useful if your form name is\n         * dynamic (interpolated).  Note interpolated form names were\n         * not implemented before AngularJS 1.3.0.\n         * Defaults to whatever the name of the form is.\n         * @type {string}\n         */\n        $alias: $attrs.alias || this.$name,\n\n        /**\n         * This form's Scope.  This will allow us to easily broadcast\n         * events within it.\n         * @type {ng.$rootScope.Scope}\n         */\n        $formScope: $scope,\n\n        /**\n         * Used to track this form's error state.  We'll need to\n         * do stuff if the state changes.\n         * @type {number}\n         */\n        $$lastErrorSize: 0,\n\n        /**\n         * If the number of errors in this form has increased or decreased\n         * and the control being set valid or invalid is a member of this\n         * form proper, then tell $envoy to broadcast an event that\n         * the form's validity changed (somewhat).\n         * @this FormController\n         */\n        $setValidity: function $envoySetValidity(token,\n          value,\n          control) {\n\n          /**\n           * If we set $isForm above, this is a subform of the parent\n           * and we don't care.\n           * @todo maybe we do care?\n           * @type {boolean}\n           */\n          var isNotForm = !control.$isForm;\n\n          /**\n           * We only care about controls that were explicitly added\n           * to this form.\n           * @type {boolean}\n           */\n          var formHasControl = isNotForm && _.has(this, control.$name);\n\n          $setValidity.apply(this, arguments);\n\n          if (formHasControl &&\n            _.size(this.$error) !== this.$$lastErrorSize) {\n            $envoy.emit(this, control);\n            this.$$lastErrorSize = _.size(this.$error);\n          }\n        }\n      });\n\n      // see the note below at formDirective.$scope\n      if (!_.has($scope, this.$alias)) {\n        $scope[this.$alias] = this;\n      }\n    }\n  }\n\n  MessagesFormController.$inject = [\n    '$element',\n    '$attrs',\n    '$scope',\n    '$animate',\n    '$interpolate',\n    '$injector',\n    '$envoy'\n  ];\n\n  form.controller = MessagesFormController;\n\n  /**\n   * So this is a little hack.  I'm pretty sure this is not dangerous, but\n   * it could be.  The reason for this is that you may have a dynamic form\n   * name; something interpolated.  Say, \"myForm-2789618\".  A FormController\n   * will always place itself on the scope if it's given a name.  But it's\n   * also handy to be able to reference \"myForm\".  If form \"myForm-87329\"\n   * shared the same scope with \"myForm-2789618\", only one \"myForm\" could\n   * exist; thus, we just make a new scope.\n   * @type {boolean}\n   */\n  form.$scope = true;\n\n  return $delegate;\n}\nformDecorator.$inject = ['$delegate'];\n\nmodule.exports = formDecorator;\n","'use strict';\n\nmodule.exports = {\n  'envoyAction': require('./action'),\n  'envoyMessages': require('./messages'),\n  'envoyList': require('./list'),\n  'envoyProxy': require('./proxy')\n};\n","'use strict';\n\nvar opts = require('./opts');\nvar _ = (typeof window !== \"undefined\" ? window._ : typeof global !== \"undefined\" ? global._ : null);\n\nvar debug = require('debug')('envoy:$envoy:provider');\n\nfunction envoyProvider() {\n\n  /**\n   * Set options during config phase\n   * @param {Object} [newOpts] New options to assign onto defaults\n   * @returns {Object}\n   */\n  this.options = function options(newOpts) {\n    _.extend(opts, newOpts);\n    debug('New options set:', opts);\n    return opts;\n  };\n\n  this.$get = require('./factory');\n\n}\n\nmodule.exports = envoyProvider;\n","\n/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  'lightseagreen',\n  'forestgreen',\n  'goldenrod',\n  'dodgerblue',\n  'darkorchid',\n  'crimson'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  return ('WebkitAppearance' in document.documentElement.style) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (window.console && (console.firebug || (console.exception && console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31);\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  return JSON.stringify(v);\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs() {\n  var args = arguments;\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return args;\n\n  var c = 'color: ' + this.color;\n  args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n  return args;\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage(){\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","'use strict';\n\n/**\n * Describes a directive wherein you can supply an action (AngularJS\n * expression) to be executed from the message list view, for a particular\n * control.  In practice, you use this to activate a control to correct\n * an error when the message list displays a problem w/ yr control.\n * @example\n * <input name=\"title\"\n *        type=\"text\"\n *        ng-model=segment.title\"\n *        message-action=\"edit(segment)\"/>\n */\nfunction action($envoy) {\n\n  return {\n    restrict: 'A',\n    require: ['ngModel', '^form'],\n    link: function (scope, element, attrs, ctrls) {\n      var ngModel = ctrls[0];\n      var form = ctrls[1];\n      var action;\n\n      if ((action = attrs.envoyAction) && ngModel.$name && form.$name) {\n        $envoy.setAction(form.$name, ngModel.$name, function () {\n          scope.$eval(action);\n        });\n      }\n    }\n  };\n}\naction.$inject = ['$envoy'];\n\nmodule.exports = action;\n","'use strict';\n\nvar opts = require('../envoy/opts');\n\n/**\n * Defines a directive which will display a list of all messages\n * for a form.\n * The form does not have to be the direct parent of this directive.\n * @example\n * <div messages-list=\"configForm\"></div>\n * <!-- or -->\n * <messages-list for=\"configForm\"></messages-list>\n */\nfunction list($envoy) {\n  return {\n    restrict: 'EA',\n    scope: true,\n    require: '^envoyMessages',\n    templateUrl: opts.templateUrl,\n    link: function (scope, element, attrs, envoyMessages) {\n      var parent = $envoy.findParentCtrl(attrs.envoyList ||\n        attrs.for, envoyMessages);\n\n      parent.bindView(scope);\n\n      scope.$on('$destroy', function () {\n        parent.unbindView();\n      });\n    }\n  };\n}\nlist.$inject = ['$envoy'];\n\nmodule.exports = list;\n","'use strict';\n\nvar _ = (typeof window !== \"undefined\" ? window._ : typeof global !== \"undefined\" ? global._ : null);\n\n/**\n * @ngdoc directive\n * @description\n * Defines a directive which, when used with ngModel, will set the validity\n * of the associated NgModelController, based on the validity of the target\n * form.\n */\nfunction proxy() {\n\n  /**\n   * Anything that needs validating needs a token, so, here's one.\n   * @type {string}\n   */\n  var TOKEN = 'proxy';\n\n  /**\n   * The class to be applied if the directive's value is present\n   * @type {string}\n   */\n  var CLASSNAME = 'errorlevel';\n\n  return {\n    restrict: 'A',\n    require: 'ngModel',\n    controller: [\n      '$scope',\n      '$element',\n      '$attrs',\n      '$envoy',\n      '$interpolate',\n      function ProxyCtrl($scope, $element, $attrs, $envoy, $interpolate) {\n\n        var debug = require('debug')('envoy:directives:proxy:controller');\n        var target = $interpolate($attrs.envoyProxy || '')($scope);\n        var ngModel = $element.controller('ngModel');\n\n        this.update = function update(data) {\n          var isValid = !data.errorLevel;\n          var errorLevelName = $envoy.level(data.errorLevel);\n          debug('Proxy \"%s\" updated w/ errorLevel %s', target, errorLevelName);\n          _.each($envoy.ERRORLEVELS, function (errorlevel, errorLevelName) {\n            $element.removeClass(errorLevelName);\n          });\n          ngModel.$setValidity(TOKEN, isValid);\n          if (!isValid) {\n            $element.addClass(errorLevelName);\n          }\n        };\n\n        this.toString = function toString() {\n          return this.$name + '-proxy';\n        };\n\n        this.$name = target;\n\n        if (target) {\n          $element.addClass(CLASSNAME);\n          $scope.$on('$destroy', $envoy.bindForm(this, target));\n        } else {\n          throw new Error('envoyProxy directive needs a value!');\n        }\n      }\n    ]\n  };\n}\nmodule.exports = proxy;\n","'use strict';\n\nvar _ = (typeof window !== \"undefined\" ? window._ : typeof global !== \"undefined\" ? global._ : null);\nvar opts = require('./opts');\n\nvar debug = require('debug')('envoy:$envoy:factory');\n\nfunction envoyFactory($http, $q) {\n\n  /**\n   * Error levels as configured in opts in order, by name\n   * @type {Array.<string>}\n   */\n  var LEVEL_ARRAY = _.pluck(opts.levels, 'name');\n\n  /**\n   * Mapping of error level names to indices in {@link LEVEL_ARRAY}\n   * @type {Object.<string,number>}\n   */\n  var LEVELS = _(LEVEL_ARRAY)\n    .invert()\n    .mapValues(_.parseInt)\n    .value();\n\n  /**\n   * Lookup of forms and controls to any actions bound via the\n   * messageAction directive.  An action is simply an AngularJS\n   * expression which will be evaluated.\n   * @type {Object.<string,Object.<string,string>>}\n   */\n  var actions = {};\n\n  /**\n   * Map of form name to MessagesCtrl bindings\n   * @type {Object.<string,MessagesCtrl>}\n   */\n  var bindings = {};\n\n  var prototype;\n\n  /**\n   * Retrieves a collection of messages for a form and/or control\n   * within that form.  If no parameters, returns the entirety of the\n   * data file.\n   * @param {FormController} form Form controller\n   * @returns {*} Value, if any\n   */\n  function $envoy(form) {\n    var result;\n    if ((result = $envoy._cache[form.$name])) {\n      return $q.when(result);\n    }\n    return $http.get(opts.dataFile, {\n      cache: true\n    })\n      .then(function (res) {\n\n        /**\n         * Entirety of the data file\n         * @type {Object}\n         */\n        var messages = res.data;\n\n        if (form) {\n          // If the form has an alias (use the \"alias\" directive),\n          // this name takes precedence.\n          messages = _(messages[form.$alias || form.$name])\n            // here we pick only the controls that are invalid.\n            .mapValues(function (controlMsgOptions, controlMsgName) {\n              var formControl = form[controlMsgName];\n              // if this is truthy, then we have errors in the given\n              // control\n              var error = formControl && _.size(formControl.$error);\n\n              if (formControl && error) {\n                // get the problem tokens and grab any actions\n                // if present.  actions are assigned at the control\n                // level, but we don't have granular control over\n                // which validation token triggers which action.\n                // so, if there were two problems with one control,\n                // both tokens would receive the action prop.\n                return _(controlMsgOptions)\n                  .pick(_.keys(formControl.$error))\n                  .each(function (tokenInfo) {\n                    tokenInfo.action =\n                      $envoy.getAction(form.$name, controlMsgName);\n                  })\n                  .value();\n\n              }\n            })\n            .value();\n        }\n\n        $envoy._cache[form.$name] = messages;\n\n        return messages;\n      });\n  }\n\n  prototype = {\n\n    _cache: {},\n\n    /**\n     * Utility function to convert an error level into a number or\n     * string\n     * @param {(number|string)} [errorLevel] Error level, or default\n     *     level\n     * @returns {(number|string)} Corresponding string/number\n     */\n    level: function level(errorLevel) {\n      return _.isString(errorLevel) ?\n      LEVELS[errorLevel] || LEVELS[opts.defaultLevel] :\n      LEVEL_ARRAY[errorLevel] || opts.defaultLevel;\n    },\n\n    /**\n     * Given a `FormController`, calculate the maximum error level\n     * for its controls which are invalid.\n     * @param {FormController} form form to inspect\n     * @returns {Promise.<string>} Level name\n     * @throws if no FormController passed\n     */\n    formErrorLevel: function formErrorLevel(form) {\n      if (!form) {\n        throw new Error('parameter is required');\n      }\n      return $envoy(form)\n        .then(function (formMessages) {\n          return $envoy._formErrorLevel(form, formMessages);\n        });\n    },\n\n    _formErrorLevel: function _formErrorLevel(form, formMessages) {\n      /**\n       * Index of the default error level\n       * @type {number}\n       */\n      var defaultLevelNum = LEVELS[opts.defaultLevel];\n\n      /**\n       * Maximum error level of all validation tokens within all\n       * controls of this form\n       * @type {number}\n       */\n      var maxLevel = _.reduce(formMessages,\n        function (result, controlMsgOpts) {\n\n          /**\n           * Maximum error level of any validation token within\n           * the control which is in \"invalid\" state.\n           * @type {number}\n           */\n          var maxControlLevel = _(controlMsgOpts)\n            .pick(function (tokenOpts, tokenName) {\n              return form.$error[tokenName];\n            })\n            .pluck('level')\n            .map($envoy.level)\n            .max();\n\n          return Math.max(result, maxControlLevel);\n        },\n        defaultLevelNum);\n\n      var errorLevelName = $envoy.level(maxLevel);\n      debug('Computed errorLevel \"%s\" for form \"%s\"',\n        errorLevelName,\n        form.$name);\n      return maxLevel;\n    },\n\n    _emitting: null,\n    bindForm: function bindForm(ctrl, formName) {\n\n      var formBindings = bindings[formName] = bindings[formName] || {};\n      var id = _.uniqueId('envoy-binding-');\n\n      formBindings[id] = ctrl;\n\n      return function unbindForm() {\n        delete formBindings[id];\n      };\n    },\n    emit: function emit(form, control) {\n      var _emit;\n\n      function findParents(ctrl, list) {\n        list = list || [];\n        if (ctrl.$parent) {\n          list.push(ctrl.$parent);\n          return findParents(ctrl.$parent, list);\n        }\n        return list;\n      }\n\n      /**\n       * For a MessageCtrl, find all children (recursively).\n       * @param {MessageCtrl} ctrl envoyMessage Controller\n       * @param {Array.<MessageCtrl>} [list=[]] Array of children\n       * @returns {Array.<MessageCtrl>} Array of children\n       */\n      function findChildren(ctrl, list) {\n        var children = ctrl.$children;\n        list = list || [];\n        if (children && children.length) {\n          list.push.apply(list, children);\n          return _(children)\n            .map(function (child) {\n              return findChildren(child, list);\n            })\n            .flatten()\n            .unique()\n            .value();\n        }\n        return list;\n      }\n\n      /**\n       * Given some controllers, set the default errorLevel if it doesn't\n       * exist.\n       * @param {...Array.<(MessageCtrl|ProxyCtrl)>} [ctrls] Arrays of\n       *     controllers\n       */\n      function setDefaultCtrlLevels() {\n        _.each(_.toArray(arguments), function (ctrls) {\n          _.each(ctrls, function (ctrl) {\n            ctrl.$errorLevel = ctrl.$errorLevel || $envoy.DEFAULT_ERRORLEVEL;\n          });\n        });\n      }\n\n      _emit = _.debounce(function _emit(form, control) {\n\n        /**\n         * All controllers that care about this form, be it envoyMessage\n         * controllers, or envoyProxy controllers.\n         * @type {Array.<(MessageCtrl|ProxyCtrl)>}\n         */\n        var boundCtrls = _.toArray(bindings[form.$name]);\n\n        /**\n         * Those of the bound controls which are envoyMessage controllers.\n         * These have actual form objects within them, so we'll use them\n         * to determine the appropriate errorlevel(s).\n         * @type {Array.<MessageCtrl>}\n         */\n        var messageCtrls;\n\n        /**\n         * All parent controllers of the messageCtrls.\n         * @type {Array.<MessageCtrl>}\n         */\n        var parentCtrls;\n\n        if (!boundCtrls.length) {\n          // nobody cares.\n          return;\n        }\n\n        messageCtrls = _.filter(boundCtrls, function (ctrl) {\n          return ctrl.$form;\n        });\n\n        parentCtrls = _(messageCtrls)\n          .map(function (child) {\n            return findParents(child);\n          })\n          .flatten()\n          .value();\n\n        // for those which don't have an $errorLevel prop set, set it.\n        setDefaultCtrlLevels(parentCtrls, messageCtrls);\n\n        $envoy._emitting = $envoy(form)\n          .then(function (formMessages) {\n            var lastErrorLevel = $envoy._formErrorLevel(form,\n              formMessages);\n            var messages = _.object([form.$name], [formMessages]);\n            var increasing;\n\n            function update(ctrl) {\n              ctrl.update({\n                messages: messages,\n                errorLevel: lastErrorLevel\n              });\n            }\n\n            if (form.$errorLevel < lastErrorLevel) {\n              increasing = true;\n            } else if (form.$errorLevel > lastErrorLevel) {\n              increasing = false;\n            } else {\n              return;\n            }\n\n            _.each(formMessages[control.$name], function (tokenInfo) {\n              tokenInfo.action = $envoy.getAction(form.$name, control.$name);\n            });\n\n            if (increasing === false) {\n              lastErrorLevel = Math.max(lastErrorLevel,\n                _(messageCtrls)\n                  .map(function (ctrl) {\n                    return findChildren(ctrl);\n                  })\n                  .flatten()\n                  .map(function (childCtrl) {\n                    return _.isNumber(childCtrl.$errorLevel) ?\n                      childCtrl.$errorLevel :\n                      $envoy.DEFAULT_ERRORLEVEL;\n                  })\n                  .max());\n            }\n\n            _.each(boundCtrls, update);\n\n            _.each(parentCtrls, function (ctrl) {\n              if (increasing) {\n                if (ctrl.$errorLevel < lastErrorLevel) {\n                  update(ctrl);\n                } else if (ctrl.$errorLevel > lastErrorLevel) {\n                  lastErrorLevel = ctrl.$errorLevel;\n                  update(ctrl);\n                }\n              } else {\n                if (ctrl.$errorLevel > lastErrorLevel) {\n                  update(ctrl);\n                } else if (ctrl.$errorLevel < lastErrorLevel) {\n                  lastErrorLevel = ctrl.$errorLevel;\n                  update(ctrl);\n                }\n              }\n            });\n          })\n          .catch(function (err) {\n            debug(err);\n          });\n      });\n\n      delete $envoy._cache[form.$name];\n\n      debug('Control \"%s\" in form \"%s\" changed validity',\n        control.$name,\n        form.$name);\n\n      if ($envoy._emitting) {\n        return $envoy._emitting.then(_emit.bind(null,\n          form,\n          control));\n      }\n\n      return $q.when(_emit(form, control));\n    },\n\n    /**\n     * Set an action to be executed at some point.  Used by the\n     * envoyList directive's view, so that you can click on an\n     * error and be taken to where the error is.\n     * @todo make controlName optional?\n     * @param {string} formName Name of form\n     * @param {string} controlName Name of control\n     * @param {string} action AngularJS expression to evaluate\n     */\n    setAction: function setAction(formName, controlName, action) {\n      var formActions = actions[formName] = actions[formName] || {};\n      formActions[controlName] = action;\n    },\n\n    /**\n     * Gets a stored action.\n     * @param {string} formName Name of form for action\n     * @param {string} controlName Name of control for action\n     * @returns {(string|undefined)} The action (AngularJS\n     *     expression), if it exists.\n     */\n    getAction: function getAction(formName, controlName) {\n      return _.get(actions, _.format('%s.%s', formName, controlName));\n    },\n\n    /**\n     * Utility function to get a parent envoy directive.\n     * @param {string} formName Find the messagesDirectiveCtrl\n     *     attached to form with this name\n     * @param {MessagesCtrl} envoyMessages Current\n     *     messagesDirectiveCtrl\n     * @returns {MessagesCtrl}\n     */\n    findParentCtrl: function findParentCtrl(formName, envoyMessages) {\n      while (envoyMessages.$name !== formName) {\n        envoyMessages = envoyMessages.$parent;\n        if (!envoyMessages) {\n          throw new Error('cannot find parent with name ' + formName);\n        }\n      }\n      return envoyMessages;\n    },\n\n    levelDescription: function levelDescription(errorLevel) {\n      return opts.levels[errorLevel].description;\n    },\n\n    /**\n     * Exposed for handiness\n     * @type {string}\n     */\n    DEFAULT_LEVEL: opts.defaultLevel,\n\n    DEFAULT_ERRORLEVEL: LEVELS[opts.defaultLevel],\n\n    /**\n     * Exposed for handiness.  The kinder, gentler version of\n     * opts.levels\n     * @type {Object.<string,number>}\n     */\n    ERRORLEVELS: LEVELS,\n\n    /**\n     * Exposed for handiness\n     * @type {Array.<Object.<string,string>>}\n     */\n    LEVELS: opts.levels,\n\n    opts: opts\n\n  };\n\n  _.extend($envoy, prototype);\n\n  return $envoy;\n}\nenvoyFactory.$inject = ['$http', '$q'];\n\nmodule.exports = envoyFactory;\n","'use strict';\n\n/**\n * This number (in ms) needs to be higher than however long it takes to\n * hide any display generated by the `messagesList` directive.\n * @type {number}\n */\nvar DEFAULT_HIDE_DELAY = 900;\n\n/**\n * Default level and descriptions\n * @type {Array.<Object.<string, string>>}\n */\nvar DEFAULT_LEVELS = [\n  {\n    name: 'ok',\n    description: 'Fixed!'\n  },\n  {\n    name: 'warning',\n    description: 'Warning'\n  },\n  {\n    name: 'error',\n    description: 'Error'\n  }\n];\n\n/**\n * Default web server path to JSON message definition file\n * @type {string}\n */\nvar DEFAULT_DATA_FILE = 'messages.json';\n\n/**\n * The default level\n * @type {string}\n */\nvar DEFAULT_LEVEL = 'ok';\n\nmodule.exports = {\n  levels: DEFAULT_LEVELS,\n  defaultLevel: DEFAULT_LEVEL,\n  dataFile: DEFAULT_DATA_FILE,\n  hideDelay: DEFAULT_HIDE_DELAY,\n  templateUrl: 'partials/messages.html'\n};\n\n","'use strict';\n\nmodule.exports = require('./messages');\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = debug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lowercased letter, i.e. \"n\".\n */\n\nexports.formatters = {};\n\n/**\n * Previously assigned color.\n */\n\nvar prevColor = 0;\n\n/**\n * Previous log timestamp.\n */\n\nvar prevTime;\n\n/**\n * Select a color.\n *\n * @return {Number}\n * @api private\n */\n\nfunction selectColor() {\n  return exports.colors[prevColor++ % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction debug(namespace) {\n\n  // define the `disabled` version\n  function disabled() {\n  }\n  disabled.enabled = false;\n\n  // define the `enabled` version\n  function enabled() {\n\n    var self = enabled;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // add the `color` if not set\n    if (null == self.useColors) self.useColors = exports.useColors();\n    if (null == self.color && self.useColors) self.color = selectColor();\n\n    var args = Array.prototype.slice.call(arguments);\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %o\n      args = ['%o'].concat(args);\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    if ('function' === typeof exports.formatArgs) {\n      args = exports.formatArgs.apply(self, args);\n    }\n    var logFn = enabled.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n  enabled.enabled = true;\n\n  var fn = exports.enabled(namespace) ? enabled : disabled;\n\n  fn.namespace = namespace;\n\n  return fn;\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  var split = (namespaces || '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (var i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","'use strict';\n\n/**\n * @ngdoc directive\n * @name fv.envoy.directive:envoyMessages\n * @requires fv.envoy.service:$envoy\n * @restrict AE\n * @param {string} [parent] If this directive is in a subform of some other\n * form which is *also* using the `messages` directive, and you wish to\n * display messages within its view, specify its form here.\n * @description\n * Enables display of messages for a form.\n */\n\n/**\n *\n *\n */\nfunction messages() {\n  return {\n    restrict: 'AE',\n    require: 'envoyMessages',\n    controller: require('./messages-ctrl'),\n    scope: true,\n    link: function link(scope, element, attrs, ctrl) {\n      scope.$on('$formStateChanged', function (evt, data) {\n        ctrl.update(data);\n      });\n\n      scope.$on('$destroy', function () {\n        ctrl.$parent.removeChild(ctrl);\n      });\n    }\n  };\n}\n\nmessages.$inject = ['$envoy'];\n\nmodule.exports = messages;\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} options\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options){\n  options = options || {};\n  if ('string' == typeof val) return parse(val);\n  return options.long\n    ? long(val)\n    : short(val);\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = '' + str;\n  if (str.length > 10000) return;\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);\n  if (!match) return;\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction short(ms) {\n  if (ms >= d) return Math.round(ms / d) + 'd';\n  if (ms >= h) return Math.round(ms / h) + 'h';\n  if (ms >= m) return Math.round(ms / m) + 'm';\n  if (ms >= s) return Math.round(ms / s) + 's';\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction long(ms) {\n  return plural(ms, d, 'day')\n    || plural(ms, h, 'hour')\n    || plural(ms, m, 'minute')\n    || plural(ms, s, 'second')\n    || ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) return;\n  if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","'use strict';\n\nvar _ = (typeof window !== \"undefined\" ? window._ : typeof global !== \"undefined\" ? global._ : null);\nvar viewData = require('./viewdata');\n\nvar debug = require('debug')('envoy:directives:messages:controller');\n\nfunction MessagesCtrl($element,\n  $envoy,\n  $attrs,\n  $scope,\n  $interpolate) {\n\n  var view;\n\n  /**\n   * Bind a view Scope to this directive for display.  Used by\n   * `messagesList` directive.\n   * @param {ng.$rootScope.Scope} scope\n   * @returns {MessagesCtrl} This controller\n   */\n  this.bindView = function bindView(scope) {\n    if (view.scope) {\n      throw new Error('view already bound!');\n    }\n    view.scope = scope;\n    scope.data = viewData($envoy.DEFAULT_LEVEL);\n    debug('View bound');\n    return this;\n  };\n\n  this.update = function update(data) {\n    var viewData = this.$viewData;\n    var errorLevel;\n\n    if (viewData) {\n\n      debug('\"%s\" updating with new data:', this.$name, data);\n\n      this.$errorLevel =\n        errorLevel =\n          _.isNumber(data.errorLevel) ? data.errorLevel : this.$errorLevel;\n\n      // this beast is kind of a custom merge\n      _.each(data.messages, function (formMessages, formName) {\n        if (viewData.messages[formName]) {\n          _.each(formMessages, function (controlMessages, controlName) {\n            if (_.isObject(controlMessages)) {\n              if (viewData.messages[formName][controlName]) {\n                _.extend(viewData.messages[formName][controlName],\n                  controlMessages);\n              } else {\n                viewData.messages[formName][controlName] = controlMessages;\n              }\n            } else {\n              delete viewData.messages[formName][controlName];\n            }\n          });\n        } else {\n          viewData.messages[formName] = formMessages;\n        }\n      });\n      viewData.error = !!errorLevel;\n      viewData.className = $envoy.level(errorLevel);\n      viewData.title = this.title(errorLevel);\n\n      debug('\"%s\" updated; view data:', this.$name, viewData);\n\n      return viewData;\n    }\n  };\n\n  /**\n   * Unbind the bound Scope of this controller.\n   * @returns {MessagesCtrl} This controller\n   */\n  this.unbindView = function unbindView() {\n    delete view.scope;\n    view = null;\n    debug('View unbound');\n    return this;\n  };\n\n  this.addChild = function addChild(child) {\n    debug('Adding child \"%s\" to \"%s\"', child.$name, this.$name);\n    this.$children.push(child);\n    child.$parent = this;\n    return this;\n  };\n\n  this.removeChild = function removeChild(child) {\n    debug('Removing child \"%s\" from \"%s\"', child.$name, this.$name);\n    this.$children.splice(this.$children.indexOf(child), 1);\n    delete child.$parent;\n    return this;\n  };\n\n  this.title = function title(errorLevel) {\n    return $envoy.levelDescription(errorLevel);\n  };\n\n  this.toString = function toString() {\n    return this.$name;\n  };\n\n  this.broadcast = $scope.$broadcast.bind($scope);\n  this.emit = $scope.$parent.$emit.bind($scope.$parent);\n\n  /**\n   * @this MessagesCtrl\n   */\n  (function init() {\n    var parentName;\n    var form;\n\n    this.$children = [];\n    this.$parent = null;\n\n    Object.defineProperties(this, {\n      $errorLevel: {\n        get: function getErrorLevel() {\n          return form.$errorLevel;\n        },\n        set: function setErrorLevel(value) {\n          form.$errorLevel = value;\n        }\n      },\n      $name: {\n        get: function getName() {\n          return form.$name;\n        }\n      },\n      $viewData: {\n        get: function getViewData() {\n          var data;\n          if ((data = _.get(view, 'scope.data'))) {\n            return data;\n          }\n          if (view.scope) {\n            return (view.scope.data = viewData($envoy.DEFAULT_LEVEL));\n          }\n        },\n        set: function setViewData(data) {\n          view.scope.data = data;\n        }\n      }\n    });\n\n    form = this.$form = $element.controller('form');\n\n    if ($attrs.parent && (parentName = $interpolate($attrs.parent)($scope))) {\n      $envoy.findParentCtrl(parentName,\n        $element.parent().controller('envoyMessages')).addChild(this);\n\n      if (this.$parent.$form === form) {\n        this.$parent.removeChild(this);\n        debug('Attempted to initialize %s with its own parent', form.$name);\n      }\n    }\n\n    this.$children = [];\n\n    view =\n      this.$parent ? (this.$view = this.$parent.$view) : (this.$view = {});\n\n    $scope.$on('$destroy', $envoy.bindForm(this, this.$name));\n\n  }.call(this));\n}\n\nMessagesCtrl.$inject = [\n  '$element',\n  '$envoy',\n  '$attrs',\n  '$scope',\n  '$interpolate'\n];\n\nmodule.exports = MessagesCtrl;\n","'use strict';\n\nvar _ = (typeof window !== \"undefined\" ? window._ : typeof global !== \"undefined\" ? global._ : null);\n\nvar ID_PREFIX = 'envoy-viewdata-';\nvar debug = require('debug')('envoy:directives:messages:viewdata');\n\nfunction viewData(defaultLevel) {\n  var data = {\n    reset: function reset() {\n      this.error = false;\n      this.messages = {};\n      this.title = null;\n      this.className = null;\n      this.errorLevel = defaultLevel;\n    },\n    id: _.uniqueId(ID_PREFIX)\n  };\n  data.reset();\n  debug('Created viewdata object with id \"%s\"', data.id);\n  return data;\n}\n\nmodule.exports = viewData;\n\n"]}